<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Book Flip — Simple Page Flip Only</title>
<style>
  html, body {
    overflow: hidden; /* prevent scrollbars during flip */
  }

  :root{ --book-width:900px; --book-height:600px; }
  *{box-sizing:border-box; user-select:none;}
  body{ margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; flex-direction:column; background:#eee; font-family:Arial, sans-serif; }

  .book{
    width:var(--book-width);
    height:var(--book-height);
    display:flex;
    position:relative;
    box-shadow:0 18px 50px rgba(0,0,0,0.15);
    background:#000;
    overflow:hidden; /* also ensures no internal scrollbars */
  }

  .left-page{
    width:50%;
    height:100%;
    background:#fff;
    overflow:hidden;
    position:relative;
    z-index:1;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .left-page img{
    max-width:100%;
    max-height:100%;
    width:auto;
    height:auto;
    object-fit:contain;
    display:block;
  }

  .right-stack{
    width:50%;
    height:100%;
    position:relative;
    perspective:2000px;
    overflow:visible;
    background:#fff;
  }

  .sheet{
    width:100%;
    height:100%;
    position:absolute;
    top:0;
    left:0;
    transform-style:preserve-3d;
    transform-origin:left center;
    z-index:50;
    will-change:transform, box-shadow;
  }

  .face{
    width:100%;
    height:100%;
    position:absolute;
    backface-visibility:hidden;
    overflow:hidden;
    background:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .face img{
    max-width:100%;
    max-height:100%;
    width:auto;
    height:auto;
    object-fit:contain;
    display:block;
  }

  .back{ transform:rotateY(180deg); }

  .controls{ margin-top:18px; display:flex; gap:12px; }
  button{ padding:8px 14px; border-radius:8px; border:1px solid #999; background:white; cursor:pointer; }
  button:disabled{ opacity:0.45; cursor:default; }
</style>

</head>
<body>

<div class="book" id="book">
  <div class="left-page" id="leftPage">
    <img id="leftImg" src="" alt="">
  </div>

  <div class="right-stack" id="rightStack"></div>
</div>

<div class="controls">
  <button id="prevBtn">◀ Prev</button>
  <button id="nextBtn">Next ▶</button>
</div>

<script>
const pages = [
  "images/page1.jpg",
  "images/page2.jpg",
  "images/page3.jpg",
  "images/page4.jpg",
  "images/page5.jpg",
  "images/page6.jpg"
];

const spreads = [];
for (let i = 0; i < pages.length; i += 2) {
  spreads.push({ left: pages[i] || '', right: pages[i+1] || '' });
}

const leftImg = document.getElementById('leftImg');
const rightStack = document.getElementById('rightStack');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const book = document.getElementById('book');

let flipped = 0;
let isAnimating = false;

/* Build sheet pages */
spreads.forEach((sp, idx) => {
  const sheet = document.createElement('div');
  sheet.className = 'sheet';
  sheet.dataset.index = idx;
  sheet.style.zIndex = 200 - idx;

  const front = document.createElement('div');
  front.className = 'face front';
  if (sp.right) front.innerHTML = `<img src="${sp.right}">`;

  const back = document.createElement('div');
  back.className = 'face back';
  if (sp.left) back.innerHTML = `<img src="${sp.left}">`;

  sheet.appendChild(front);
  sheet.appendChild(back);
  rightStack.appendChild(sheet);
});

leftImg.src = spreads[0].left;

/* animation easing */
function easeOutQuad(t){ return 1 - (1 - t) * (1 - t); }

/* PURE page flip: no cover, no scaling */
function animateFlip(sheet, direction = 'next', duration = 900){
  if (isAnimating) return Promise.reject('Animating...');
  isAnimating = true;
  setControls(false);

  const start = performance.now();
  const from = (direction === 'next') ? 0 : -180;
  const to   = (direction === 'next') ? -180 : 0;

  return new Promise(resolve => {
    function frame(now){
      let t = Math.min(1, (now - start) / duration);
      let eased = easeOutQuad(t);
      let angle = from + (to - from) * eased;

      sheet.style.transform = `rotateY(${angle}deg)`;

      if (t < 1) {
        requestAnimationFrame(frame);
      } else {
        sheet.style.transform = `rotateY(${to}deg)`;
        isAnimating = false;
        setControls(true);
        resolve();
      }
    }
    requestAnimationFrame(frame);
  });
}

async function goNext(){
  if (isAnimating) return;
  if (flipped >= spreads.length - 1) return;

  const sheet = rightStack.querySelector(`.sheet[data-index="${flipped}"]`);
  await animateFlip(sheet, 'next');
  flipped++;
  leftImg.src = spreads[flipped].left;
}

async function goPrev(){
  if (isAnimating) return;
  if (flipped <= 0) return;

  const idx = flipped - 1;
  const sheet = rightStack.querySelector(`.sheet[data-index="${idx}"]`);
  await animateFlip(sheet, 'prev');
  flipped--;
  leftImg.src = spreads[flipped].left;
}

function setControls(enabled){
  nextBtn.disabled = !enabled || (flipped >= spreads.length - 1);
  prevBtn.disabled = !enabled || (flipped <= 0);
}

nextBtn.addEventListener('click', goNext);
prevBtn.addEventListener('click', goPrev);

book.addEventListener('click', (e) => {
  if (isAnimating) return;
  const rect = book.getBoundingClientRect();
  const clickX = e.clientX - rect.left;
  if (clickX > rect.width / 2) goNext();
  else goPrev();
});

document.addEventListener('keydown', e => {
  if (isAnimating) return;
  if (e.key === 'ArrowRight') goNext();
  if (e.key === 'ArrowLeft') goPrev();
});

setControls(true);
</script>

</body>
</html>
