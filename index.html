<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Book Flip â€” Fullscreen</title>

<style>
  html, body {
    margin:0; padding:0;
    width:100%; height:100%;
    overflow:hidden; /* no scrollbars */
    background:#e9e9ea;
    user-select:none;
  }

  :root{
    --page-bg:#fff;
  }

  *{ box-sizing:border-box; -webkit-user-drag:none; }

  /* The BOOK fills the viewport height */
  .book-area {
    width:100%;
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .book{
    height:95vh;                /* Fullscreen height */
    aspect-ratio:3/2;           /* Keep natural book shape */
    display:flex;
    background:#ddd;
    box-shadow:0 24px 60px rgba(0,0,0,0.18);
    border-radius:4px;
    overflow:hidden;
    position:relative;
  }

  /* Left Page */
  .left-page{
    width:50%; height:100%;
    background:var(--page-bg);
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
    position:relative;
    padding:10px;
  }

  /* Crossfade support */
  .img-wrap{ width:100%; height:100%; position:relative; }
  .img-wrap img{
    position:absolute;
    width:100%; height:100%;
    object-fit:contain;
    transition:opacity .25s ease;
  }

  /* Right Stack */
  .right-stack{
    width:50%; height:100%;
    perspective:2000px;
    position:relative;
    padding:10px;
    background:var(--page-bg);
  }

  .sheet{
    width:100%; height:100%;
    position:absolute; top:0; left:0;
    transform-style:preserve-3d;
    transform-origin:left center;
    pointer-events:none;
  }

  .face{
    position:absolute;
    width:100%; height:100%;
    backface-visibility:hidden;
    background:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
    border-radius:3px;
  }

  .face img{
    max-width:100%;
    max-height:100%;
    object-fit:contain;
  }

  .back{ transform:rotateY(180deg); }

  /* No buttons anymore */
</style>
</head>

<body>

<div class="book-area">
  <div class="book" id="book">

    <div class="left-page">
      <div class="img-wrap">
        <img id="leftA" style="opacity:1">
        <img id="leftB" style="opacity:0">
      </div>
    </div>

    <div class="right-stack" id="rightStack"></div>

  </div>
</div>

<script>
/* pages */
const pages = [
  "images/page1.jpg",
  "images/page2.jpg",
  "images/page3.jpg",
  "images/page4.jpg",
  "images/page5.jpg",
  "images/page6.jpg"
];

/* Build spreads (left/right) */
const spreads = [];
for (let i=0;i<pages.length;i+=2){
  spreads.push({ left:pages[i]||'', right:pages[i+1]||'' });
}

/* elements */
const leftA = document.getElementById('leftA');
const leftB = document.getElementById('leftB');
let leftFlag = true;

const rightStack = document.getElementById('rightStack');
const book = document.getElementById('book');

let flipped = 0;
let animating = false;

/* Build right sheets */
spreads.forEach((sp, idx)=>{
  const s = document.createElement('div');
  s.className='sheet';
  s.dataset.index=idx;
  s.style.zIndex = 200 - idx;

  const front = document.createElement('div');
  front.className='face front';
  if(sp.right) front.innerHTML = `<img src="${sp.right}">`;

  const back = document.createElement('div');
  back.className='face back';
  if(sp.left) back.innerHTML = `<img src="${sp.left}">`;

  s.appendChild(front);
  s.appendChild(back);
  rightStack.appendChild(s);
});

/* Initialize left page */
leftA.src = spreads[0].left;

/* easing */
function easeOut(t){ return 1 - Math.pow(1-t,3); }

/* Flip animation */
function animateFlip(sheet, dir='next', dur=850){
  if(animating) return Promise.reject();
  animating=true;

  const start = performance.now();
  const from = dir==='next' ? 0 : -180;
  const to   = dir==='next' ? -180 : 0;

  return new Promise(res=>{
    function frame(now){
      let t = Math.min(1,(now-start)/dur);
      let e = easeOut(t);
      let angle = from + (to-from)*e;

      sheet.style.transform = `rotateY(${angle}deg)`;

      if(t<1) requestAnimationFrame(frame);
      else{
        sheet.style.transform=`rotateY(${to}deg)`;
        animating=false;
        res();
      }
    }
    requestAnimationFrame(frame);
  });
}

/* crossfade left page */
function showLeft(src){
  const top = leftFlag ? leftB : leftA;
  const bottom = leftFlag ? leftA : leftB;
  top.src = src;
  top.style.opacity=1;
  bottom.style.opacity=0;
  leftFlag = !leftFlag;
}

/* Next page */
async function goNext(){
  if(animating || flipped>=spreads.length-1) return;
  const sheet = rightStack.querySelector(`.sheet[data-index="${flipped}"]`);
  await animateFlip(sheet,'next');
  flipped++;
  showLeft(spreads[flipped].left);
}

/* Prev page */
async function goPrev(){
  if(animating || flipped<=0) return;
  const sheet = rightStack.querySelector(`.sheet[data-index="${flipped-1}"]`);
  await animateFlip(sheet,'prev');
  flipped--;
  showLeft(spreads[flipped].left);
}

/* Click to navigate */
book.addEventListener('click', e=>{
  if(animating) return;
  const rect = book.getBoundingClientRect();
  const x = e.clientX - rect.left;
  if(x > rect.width/2) goNext();
  else goPrev();
});

/* Keyboard */
document.addEventListener('keydown', e=>{
  if(e.key==='ArrowRight') goNext();
  if(e.key==='ArrowLeft') goPrev();
});

/* Mobile swipe */
let startX = null;
book.addEventListener('touchstart',e=>{
  if(e.touches.length===1) startX=e.touches[0].clientX;
},{passive:true});

book.addEventListener('touchend',e=>{
  if(startX===null) return;
  const dx = e.changedTouches[0].clientX - startX;
  startX=null;
  if(Math.abs(dx)<30) return;
  dx<0 ? goNext() : goPrev();
});
</script>

</body>
</html>
